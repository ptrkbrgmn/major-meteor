---
// An Astro component is made up of two main parts: the Component Script and the Component Template


// 1. The Component Script
// - importing other Astro components
// - importing other framework components, like React
// - importing data, like a JSON file
// - fetching content from an API or database
// - creating variables that you will reference in your template

import MainLayout from '../layouts/MainLayout.astro';
import LikeButtonIsland from '../components/like-button/LikeButtonIsland.astro';
import UserInfo from '../components/UserInfo';
import type { User } from '../types/user';


let users: User[] = []; 
try {
  const res = await fetch('https://jsonplaceholder.typicode.com/users');
  if (!res.ok) throw new Error('Failed to fetch users');
  users = await res.json();
} catch (err) {
  console.error('Error fetching users:', err);
}
---
<!-- 2. The Component Template -->

<MainLayout title="Users (SSR)">
  <h1>Users (SSR)</h1>
  <ul>
    {users.map(user => (
      <li style={{ marginBottom: '1rem' }}>
        <UserInfo id={user.id} name={user.name} email={user.email} />
        <LikeButtonIsland />
      </li>
    ))}
  </ul>
</MainLayout>